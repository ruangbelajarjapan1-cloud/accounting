<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>RBMJ — Admin</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://unpkg.com/lucide-static@0.321.0/font/lucide.css" rel="stylesheet">
  <style>.card{border-radius:16px;background:#fff;box-shadow:0 6px 18px rgba(2,6,23,.08);padding:16px}</style>
</head>
<body class="bg-slate-50 text-slate-900">
<div class="min-h-screen grid grid-cols-1 md:grid-cols-[260px_1fr]">
  <aside class="bg-white border-r hidden md:flex flex-col">
    <div class="p-4 flex items-center gap-3 border-b">
      <img id="ui-logo" class="w-10 h-10 rounded-xl object-cover" alt="Logo">
      <div>
        <div class="font-bold">RBMJ Admin</div>
        <div class="text-xs text-slate-500">Ruang Belajar Muslim Jepang</div>
      </div>
    </div>
    <nav class="p-2 space-y-1 text-sm">
      <button data-page="dashboard"  class="nav w-full text-left px-3 py-2 rounded-lg hover:bg-slate-100">🏠 Dashboard</button>
      <button data-page="students"   class="nav w-full text-left px-3 py-2 rounded-lg hover:bg-slate-100">👨‍👩‍👧 Siswa</button>
      <button data-page="teachers"   class="nav w-full text-left px-3 py-2 rounded-lg hover:bg-slate-100">👩‍🏫 Guru</button>
      <button data-page="classes"    class="nav w-full text-left px-3 py-2 rounded-lg hover:bg-slate-100">🏷️ Kelas</button>
      <button data-page="enrollments"class="nav w-full text-left px-3 py-2 rounded-lg hover:bg-slate-100">🧩 Enrollments</button>
      <button data-page="attendance" class="nav w-full text-left px-3 py-2 rounded-lg hover:bg-slate-100">🗓️ Absensi</button>
      <button data-page="payments"   class="nav w-full text-left px-3 py-2 rounded-lg hover:bg-slate-100">💳 Pembayaran</button>
      <button data-page="invoices"   class="nav w-full text-left px-3 py-2 rounded-lg hover:bg-slate-100">🧾 Invoice & Kwitansi</button>
      <button data-page="mukafaah"   class="nav w-full text-left px-3 py-2 rounded-lg hover:bg-slate-100">🕌 Mukafaah Guru</button>
      <button data-page="expenses"   class="nav w-full text-left px-3 py-2 rounded-lg hover:bg-slate-100">🧾 Pengeluaran</button>
      <button data-page="cashbook"   class="nav w-full text-left px-3 py-2 rounded-lg hover:bg-slate-100">📕 Buku Kas</button>
      <button data-page="reports"    class="nav w-full text-left px-3 py-2 rounded-lg hover:bg-slate-100">📊 Rekapan</button>
    </nav>
  </aside>

 <main class="p-3 md:p-6">
  <!-- Endpoint + Ping -->
  <div class="card mb-3">
    <div class="flex flex-wrap items-center gap-2">
      <input id="endpoint-input" class="border rounded-lg px-3 py-2 w-full md:w-[520px]" placeholder="Paste URL Web App (…/exec)">
      <button class="px-3 py-2 rounded-lg bg-sky-600 text-white" onclick="uiSetEndpoint()">Set Endpoint</button>
      <button class="px-3 py-2 rounded-lg bg-slate-700 text-white" onclick="ping()">Ping</button>
      <span id="endpoint-show" class="text-xs text-slate-500"></span>
    </div>
  </div>

  <!-- Dashboard -->
  <section id="page-dashboard" class="page">
    <div class="grid md:grid-cols-3 gap-3">
      <div class="card"><div class="text-sm text-slate-500">Total Siswa</div><div id="stat-students" class="text-3xl font-bold">–</div></div>
      <div class="card"><div class="text-sm text-slate-500">Total Kelas</div><div id="stat-classes" class="text-3xl font-bold">–</div></div>
      <div class="card"><div class="text-sm text-slate-500">Pembayaran bulan ini</div><div id="stat-payments" class="text-3xl font-bold">–</div></div>
    </div>
  </section>

  <!-- Siswa -->
  <section id="page-students" class="page hidden">
    <div class="card">
      <div class="flex items-center justify-between mb-2">
        <h2 class="font-semibold">Siswa</h2>
        <button class="px-3 py-1.5 rounded-lg bg-sky-600 text-white" onclick="openStudentForm()">Tambah</button>
      </div>
      <input id="search-students" placeholder="Cari nama/orang tua..." class="w-full mb-2 border rounded-lg px-3 py-2">
      <div id="students-table" class="overflow-auto"></div>
    </div>
  </section>

  <!-- Guru -->
  <section id="page-teachers" class="page hidden">
    <div class="card">
      <div class="flex items-center justify-between mb-2">
        <h2 class="font-semibold">Guru</h2>
        <button class="px-3 py-1.5 rounded-lg bg-sky-600 text-white" onclick="openTeacherForm()">Tambah</button>
      </div>
      <div id="teachers-table"></div>
    </div>
  </section>

  <!-- Kelas -->
  <section id="page-classes" class="page hidden">
    <div class="card">
      <div class="flex items-center justify-between mb-2">
        <h2 class="font-semibold">Kelas</h2>
        <button class="px-3 py-1.5 rounded-lg bg-sky-600 text-white" onclick="openClassForm()">Tambah</button>
      </div>
      <div id="classes-table"></div>
    </div>
  </section>

  <!-- Enrollments -->
  <section id="page-enrollments" class="page hidden">
    <div class="card">
      <div class="flex items-center justify-between mb-2">
        <h2 class="font-semibold">Enrollments</h2>
        <button class="px-3 py-1.5 rounded-lg bg-sky-600 text-white" onclick="openEnrollForm()">Tambah</button>
      </div>
      <div id="enrollments-table"></div>
    </div>
  </section>

  <!-- Absensi -->
  <section id="page-attendance" class="page hidden">
    <div class="card">
      <div class="flex items-center justify-between mb-2">
        <h2 class="font-semibold">Absensi</h2>
        <button class="px-3 py-1.5 rounded-lg bg-sky-600 text-white" onclick="openAttendanceForm()">Input</button>
      </div>
      <div id="attendance-table"></div>
    </div>
  </section>

  <!-- Pembayaran -->
  <section id="page-payments" class="page hidden">
    <div class="card">
      <div class="flex items-center justify-between mb-3">
        <h2 class="font-semibold">Pembayaran SPP</h2>
        <div class="flex gap-2">
          <input id="pay-month" type="month" class="border rounded-lg px-3 py-2">
          <button class="px-3 py-1.5 rounded-lg bg-sky-600 text-white" onclick="openPaymentModal()">Bayar</button>
        </div>
      </div>
      <div id="payments-table"></div>
    </div>
  </section>

  <!-- Invoice -->
  <section id="page-invoices" class="page hidden">
    <div class="card">
      <div class="flex items-center justify-between mb-3">
        <h2 class="font-semibold">Invoice & Kwitansi</h2>
        <div class="flex gap-2">
          <input id="inv-month" type="month" class="border rounded-lg px-3 py-2">
          <button class="px-3 py-1.5 rounded-lg bg-sky-600 text-white" onclick="generateInvoices()">Generate Invoice Bulanan</button>
        </div>
      </div>
      <div id="invoices-table"></div>
    </div>
  </section>

  <!-- Mukafaah -->
  <section id="page-mukafaah" class="page hidden">
    <div class="card">
      <div class="flex items-center justify-between mb-3">
        <h2 class="font-semibold">Mukafaah Guru (70%)</h2>
        <div class="flex gap-2">
          <input id="muka-month" type="month" class="border rounded-lg px-3 py-2">
          <button class="px-3 py-1.5 rounded-lg bg-sky-600 text-white" onclick="loadMukafaah()">Hitung</button>
        </div>
      </div>
      <div id="mukafaah-table"></div>
    </div>
  </section>

  <!-- Pengeluaran -->
  <section id="page-expenses" class="page hidden">
    <div class="card">
      <div class="flex items-center justify-between mb-3">
        <h2 class="font-semibold">Pengeluaran</h2>
        <button class="px-3 py-1.5 rounded-lg bg-sky-600 text-white" onclick="openExpenseForm()">Tambah</button>
      </div>
      <div id="expenses-table"></div>
    </div>
  </section>

  <!-- Kas -->
  <section id="page-cashbook" class="page hidden">
    <div class="card">
      <h2 class="font-semibold mb-2">Buku Kas Bulanan</h2>
      <div class="flex gap-2 mb-2">
        <input id="cash-month" type="month" class="border rounded-lg px-3 py-2">
        <button class="px-3 py-1.5 rounded-lg bg-sky-600 text-white" onclick="loadCashbook()">Muat</button>
      </div>
      <div id="cashbook-table"></div>
    </div>
  </section>

  <!-- MODAL PEMBAYARAN -->
  <div id="pay-modal" class="fixed inset-0 hidden items-center justify-center bg-black/40 z-50">
    <div class="bg-white rounded-2xl w-[680px] max-w-[92vw] p-5">
      <div class="flex items-center justify-between mb-3">
        <h3 class="font-semibold">Input Pembayaran</h3>
        <button class="text-slate-500" onclick="closePayModal()">✕</button>
      </div>
      <div class="grid md:grid-cols-2 gap-3">
        <div>
          <label class="text-sm text-slate-600">Siswa</label>
          <select id="pay-student" class="w-full border rounded-lg px-3 py-2"></select>
        </div>
        <div>
          <label class="text-sm text-slate-600">Bulan</label>
          <input id="pay-month-modal" type="month" class="w-full border rounded-lg px-3 py-2">
        </div>
        <div class="md:col-span-2">
          <label class="text-sm text-slate-600">Kelas (boleh pilih lebih dari satu)</label>
          <select id="pay-classes" class="w-full border rounded-lg px-3 py-2" multiple size="6"></select>
          <div class="text-xs text-slate-500 mt-1">Jika tidak memilih kelas apa pun, pembayaran dianggap umum (bukan per kelas).</div>
        </div>
        <div>
          <label class="text-sm text-slate-600">Nominal (JPY)</label>
          <input id="pay-amount" type="number" class="w-full border rounded-lg px-3 py-2" placeholder="contoh: 5000">
        </div>
        <div>
          <label class="text-sm text-slate-600">Metode</label>
          <select id="pay-method" class="w-full border rounded-lg px-3 py-2">
            <option>Cash</option><option>Transfer</option><option>QR</option>
          </select>
        </div>
      </div>
      <div class="mt-4 flex justify-end gap-2">
        <button class="px-3 py-2 rounded-lg bg-slate-200" onclick="closePayModal()">Batal</button>
        <button class="px-3 py-2 rounded-lg bg-sky-600 text-white" onclick="submitPayment()">Simpan</button>
      </div>
    </div>
  </div>
</main>

</div>

<script src="./app.js"></script>
</body>
</html>
